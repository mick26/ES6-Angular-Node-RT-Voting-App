{"version":3,"file":"C:/GitHub-Repos/2015/ES6-Traceur-MEAN-RT-Voting-App/public/src/js/controllers/voteController.js","sources":["@traceur/generated/TemplateParser/6","@traceur/generated/TemplateParser/5","controllers/voteController.js","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/10","@traceur/generated/TemplateParser/8","@traceur/generated/TemplateParser/3","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/2"],"names":[],"mappings":"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","sourceRoot":"..","sourcesContent":["define($__placeholder__0, $__placeholder__1);","function($__placeholder__0) {\n      $__placeholder__1\n    }","/*================================================\r\nController for an individual poll\r\n================================================ */\r\n\r\n'use strict';\r\n\r\n/*================================================================\r\n- Define a class\r\n- The class will be registered as a controller\r\n=================================================================*/\r\nexport default class PollItemCtrl {\r\n\r\n\tconstructor($scope, $routeParams, $timeout, socket, votingService, dataFormatService) {\r\n\r\n\t\t$scope.error = \"\";\r\n\t\t$scope.poll = [];\r\n\t\t$scope.pieData = [];\r\n\t\tvar pieDataRow = {};\r\n\t\t$scope.pieChartLabels = [];\r\n\t\t$scope.pieChartData = [];\r\n\r\n\r\n\t\t/**\r\n\t\t * The following 3 functions are for nvd3 PieChart\r\n\t\t */\r\n\t\t//Function that allows nvd3.js and d3.js to access x values from the ‘data’.\r\n\t\t$scope.xFunction = function() {\r\n\t    \treturn function(d) {\r\n\t        \treturn d.key;\r\n\t    \t};\r\n\t\t}\r\n\r\n\t\t//Function that allows nvd3 and d3 to access y values from the ‘data’.\r\n\t\t$scope.yFunction = function() {\r\n\t\t\treturn function(d) {\r\n\t\t\t\treturn d.y;\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tvar colorArray = ['#000000', '#660000', '#CC0000', '#FF6666', '#FF3333', '#FF6666', '#FFE6E6'];\r\n\t\t$scope.colorFunction = function() {\r\n\t\t\treturn function(d, i) {\r\n\t\t    \treturn colorArray[i];\r\n\t\t    };\r\n\t\t}\r\n\r\n\r\n\t\t//Request\r\n\t\tvotingService.getVoteData($routeParams.pollId)\r\n\t\t//response Handler\r\n\t\t.then(function(voteData) {\r\n\t\t\t$scope.poll = voteData;\t\r\n\t\t\t//Request\r\n\t\t\tvar promise = dataFormatService.prepDataForPie(voteData);\t\t\r\n\t\t\t//Response\r\n\t\t\tpromise.then(function(formattedPieData) {\r\n\t\t\t\t$scope.pieData = formattedPieData;\r\n\t\t\t})\t\t\r\n\t\t},\r\n\t\tfunction(error) {\r\n\t\t \tscope.error = \"Error getting single poll: \" + voteData;\r\n\t\t});\r\n\r\n\r\n\r\n\t\t/*\r\n\t\t * Sent in response to a user that voted (not broadcast to all) \r\n\t\t */\r\n\t\tsocket.on('myvote', function(data) {\r\n\t\t\tif(data._id === $routeParams.pollId) {\r\n\t\t\t\t$scope.poll = data;\r\n\r\n\t\t\t\t//Request\r\n\t\t\t\tvar promise = dataFormatService.prepDataForPie(data);\t\t\r\n\t\t\t\t//Response\r\n\t\t\t\tpromise.then(function(formattedPieData) {\r\n\t\t\t\t\t$scope.pieData = formattedPieData;\r\n\t\t\t\t})\t\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\r\n\t\t/*\r\n\t\t * broadcast from server with updated vote data \r\n\t\t * send to all users except last user that voted\r\n\t\t */\r\n\t\tsocket.on('vote', function(data) {\r\n\t\t\tif(data._id === $routeParams.pollId) {\r\n\r\n\t\t\t\tif(data._id === $routeParams.pollId) {\r\n\t\t\t\t\t$scope.poll = data;\r\n\r\n\t\t\t\t\t//Request\r\n\t\t\t\t\tvar promise = dataFormatService.prepDataForPie(data);\t\t\r\n\t\t\t\t\t//Response\r\n\t\t\t\t\tpromise.then(function(formattedPieData) {\r\n\t\t\t\t\t\t$scope.pieData = formattedPieData;\r\n\t\t\t\t\t})\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\r\n\t\t/**\r\n\t\t * Vote function\r\n\t\t */ \t\r\n\t\t$scope.vote = function() {\r\n\r\n\t\t\t$scope.error = \"\";\r\n\t\t\tvar pollId = $scope.poll._id;\r\n\t\t\tvar choiceId = $scope.poll.userVote;\r\n\t\t\t\r\n\t\t\tif(choiceId) {\r\n\t\t\t\t//populate vote Object\r\n\t\t\t\tvar voteObj = { poll_id: pollId, choice: choiceId };\r\n\t\t\t\t//send the vote Object to server\r\n\t\t\t\tsocket.emit('send:vote', voteObj, function(error, data) {\r\n\t\t\t\t\tif(error) {\r\n\t\t\t\t\t\t$scope.error(\"Error sending Vote to server\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(data) {\r\n\t\t\t\t\t\t$scope.error(\"Vote sent to server\");\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} \r\n\t\t\telse {\r\n\t\t\t\t$scope.error = \"You must select an option to vote for\";\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n};\r\n","var $__placeholder__0 = $__placeholder__1","($traceurRuntime.createClass)($__placeholder__0, $__placeholder__1, $__placeholder__2)","var $__default = $__placeholder__0","return $__placeholder__0","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true"]}